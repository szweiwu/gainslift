library(reshape2)
#' gainslift plot.gainsdata Function
#'
#'
#' @param gainsdata A gainsdata object.
#' see \code{gainsdata}.
#'
#' @param title a text label for the main title.
#'
#' @param xlabel a text label for the x axis.
#'
#' @param ylabel a text label for the y axis.
#'
#'
#' @usage
#' gainschart(gainsdata, title = NULL, xlabel = NULL, ylabel = NULL)
#'
#' @export
plot.gainsdata <- function(gainsdata, title = NULL, xlabel = NULL, ylabel = NULL){
  chart_type <- gainsdata$table_type
  data <- gainsdata$data

  # Plot charts
  switch(chart_type,
    'cum' = {
      plot_obj <- gains_chart(data, title, xlabel, ylabel)
    },
    'profit' = {
      plot_obj <- profit_gains_chart(data, title, xlabel, ylabel)
    },
    'decile' = {
      plot_obj <- decile_gains_chart(data, title, xlabel, ylabel)
    },
    'profit_decile' = {
      plot_obj <- decile_profit_gains_chart(data, title, xlabel, ylabel)
    },
    'noncum' = {
      plot_obj <- noncum_decile_gains_chart(data, title, xlabel, ylabel)
    },
    'profit_noncum' = {
      plot_obj <- noncum_decile_profit_gains_chart(data, title, xlabel, ylabel)
    }
  )
  # return object
  obj <- list(data = data,
              table_type = chart_type,
              plot_object = plot_obj
              )
  class(obj) <- "plot.gainsdata"

  return(obj)
}

#' gainslift plot.gainsdata.diffsize Function
#'
#'
#' @param gainsdata.diffsize A gainsdata.diffsize object.
#' see \code{gainsdata.diffsize}.
#'
#' @param title a text label for the main title.
#'
#' @param xlabel a text label for the x axis.
#'
#' @param ylabel a text label for the y axis.
#'
#'
#' @usage
#' plot.gainsdata.diffsize(gainsdata.diffsize, title = NULL, xlabel = NULL, ylabel = NULL)
#'
#' @export
plot.gainsdata.diffsize <- function(gainsdata.diffsize, title = NULL, xlabel = NULL, ylabel = NULL){
  chart_type <- gainsdata.diffsize$table_type
  data <- gainsdata.diffsize$data

  # Plot charts
  switch(chart_type,
    'cum' = {
      plot_obj <- gains_chart(data, title, xlabel, ylabel)
    },
    'decile' = {
      plot_obj <- decile_gains_chart(data, title, xlabel, ylabel)
    },
    'noncum' = {
      plot_obj <- noncum_decile_gains_chart(data, title, xlabel, ylabel)
    },
    {
      stop('Wrong type: Profit charts not provided')
    }
  )
  # return object
  obj <- list(data = data,
              table_type = chart_type,
              plot_object = plot_obj
  )
  class(obj) <- "plot.gainsdata.diffsize"

  return(obj)
}

#' gainslift plot.liftdata Function
#'
#'
#' @param liftdata A liftdata object.
#' see \code{liftdata}.
#'
#' @param title a text label for the main title.
#'
#' @param xlabel a text label for the x axis.
#'
#' @param ylabel a text label for the y axis.
#'
#'
#' @usage
#' plot.liftdata(liftdata, title = NULL, xlabel = NULL, ylabel = NULL)
#'
#' @export
plot.liftdata <- function(liftdata, title = NULL, xlabel = NULL, ylabel = NULL){
  chart_type <- liftdata$table_type
  data <- liftdata$data

  # Plot charts
  switch(chart_type,
   'cum' = {
     plot_obj <- lift_chart(data, title, xlabel, ylabel)
   },
   'profit' = {
     plot_obj <- profit_lift_chart(data, title, xlabel, ylabel)
   },
   'decile' = {
     plot_obj <- decile_lift_chart(data, title, xlabel, ylabel)
   },
   'profit_decile' = {
     plot_obj <- decile_profit_lift_chart(data, title, xlabel, ylabel)
   },
   'noncum' = {
     plot_obj <- noncum_decile_lift_chart(data, title, xlabel, ylabel)
   },
   'profit_noncum' = {
     plot_obj <- noncum_decile_profit_lift_chart(data, title, xlabel, ylabel)
   }
  )
  # return object
  obj <- list(data = data,
              table_type = chart_type,
              plot_object = plot_obj
  )
  class(obj) <- "plot.liftdata"

  return(obj)
}

#' gainslift plot.liftdata.diffsize Function
#'
#'
#' @param liftdata.diffsize A liftdata.diffsize object.
#' see \code{liftdata.diffsize}.
#'
#' @param title a text label for the main title.
#'
#' @param xlabel a text label for the x axis.
#'
#' @param ylabel a text label for the y axis.
#'
#'
#' @usage
#' plot.liftdata.diffsize(liftdata.diffsize, title = NULL, xlabel = NULL, ylabel = NULL)
#'
#' @export
plot.liftdata.diffsize <- function(liftdata.diffsize, title = NULL, xlabel = NULL, ylabel = NULL){
  chart_type <- liftdata.diffsize$table_type
  data <- liftdata.diffsize$data

  # Plot charts
  switch(chart_type,
   'cum' = {
     plot_obj <- lift_chart(data, title, xlabel, ylabel)
   },
   'decile' = {
     plot_obj <- decile_lift_chart(data, title, xlabel, ylabel)
   },
   'noncum' = {
     plot_obj <- noncum_decile_lift_chart(data, title, xlabel, ylabel)
   },
   {
     stop('Wrong type: Profit charts not provided')
   }
  )
  # return object
  obj <- list(data = data,
              table_type = chart_type,
              plot_object = plot_obj
  )
  class(obj) <- "plot.liftdata.diffsize"

  return(obj)
}
